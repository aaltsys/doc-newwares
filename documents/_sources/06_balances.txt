.. _balances:

#############################
Inventory Balances Posting
#############################

WARES accumulates, or totals, posting quantity information by lot and product. 
The effect of this accumulation depends on the product :ref:`track-list`.

Inventory product and lot balances are stored in a balances table. Fungible 
items which are product-tracked (tracking='P') have one balances record, as 
these items do not use lot control. Items which are tracked by lot and unit will 
have a record for each lot control value in the inventory, plus one master 
balances record for the product itself, since product balance records omit lot
control codes and values. 

.. note::
   Classic DOS WARES optionally includes unit information, but it tracks product 
   quantity exclusively by lot control (tracking='C'). In DOS WARES inventory
   balances are stored in the lot transaction details file.

Posting Lot Balances Example
=============================

Suppose an account has the three products shown:

+---------+---------+-----------------+-------+----------+----------+----------+
| Product | Variety | Description     | Track || Content || Content || Unit    |
|         |         |                 |       || UOM     || Count   || UOM     |
+=========+=========+=================+=======+==========+==========+==========+
| UAB123  | (null)  | 12/16OZ Beans   |  U    | CA       | 96       | PL       |
+---------+---------+-----------------+-------+----------+----------+----------+
| CDE456  | (null)  | 11x7x9 KDCarton |  C    | PC       | 270      | BD       |
+---------+---------+-----------------+-------+----------+----------+----------+
| PFG789  | (null)  | 4-way pallets   |  P    | PC       | 1        | EA       |
+---------+---------+-----------------+-------+----------+----------+----------+

UAB123 Transaction Balances
=============================

Product UAB123 has 4 lots in inventory, each consisting of 3 pallet units with 
96 cases per pallet. One lot has two damaged units, and one lot is in transit. 
The oldest lot has two pallet units reserved for shipment. Transactions for this 
inventory might look like the following:

UAB123 Transactions
-----------------------------

+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| TP | SS| POSTDATE  | PRODUCT | CONTROL  | UNIT ID  | C| UOM| ON-HAND | RESERVED| COUNTPER|
+====+===+===========+=========+==========+==========+==+====+=========+=========+=========+
| --- 3 sequentially identified good units received on 08-17-2015 ---                      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-17-2015| UAB123  | 20150817 | 55555001 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-17-2015| UAB123  | 20150817 | 55555002 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-17-2015| UAB123  | 20150817 | 55555003 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| --- 3 sequentially identified good units received on 08-27-2015 ---                      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-27-2015| UAB123  | 20150827 | 55566001 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-27-2015| UAB123  | 20150827 | 55566002 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-27-2015| UAB123  | 20150827 | 55566003 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| --- 1 good unit received on 09-15-2015 ---                                               |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 09-15-2015| UAB123  | 20150915 | 55574001 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| --- along with 2 damaged units in the same 09-15-2015 receipt ---                        |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 09-15-2015| UAB123  | 20150915 | 55574021 | D| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 09-15-2015| UAB123  | 20150915 | 55574022 | D| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| --- an order for 2 units to ship on 09-22-2015, from oldest available lot ---            |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 1 | 09-22-2015| UAB123  | 21050817 |          | G| CA | 0       | -192    | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| --- an in-transit receipt for 3 units to arrive on 09-21-2015 ---                        |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 2 | 09-21-2015| UAB123  | 20150921 | 55588003 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 2 | 09-21-2015| UAB123  | 20150921 | 55588003 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 2 | 09-21-2015| UAB123  | 20150921 | 55588003 | G| CA | 96      | 0       | 96      |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+

The preceding transactions would post into inventory balances as shown following.

UAB123 Lot Balances
-----------------------------

+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| Product| Control | C|| UOM| On-Hand| Reserved| Available|| UOM| On-Hand| Reserved| Available|
+========+=========+==++====+========+=========+==========++====+========+=========+==========+
| UAB123 |         | G|| CA | 672    | 96      | 768      || PL | 7      | 1       | 8        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| UAB123 |         | D|| CA | 192    | 0       | 0        || PL | 2      | 0       | 0        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| UAB123 | 20150817| G|| CA | 288    | -192    | 0        || PL | 3      | -3      | 0        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| UAB123 | 20150827| G|| CA | 288    | 0       | 288      || PL | 3      | 0       | 3        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| UAB123 | 20150915| G|| CA | 96     | 0       | 96       || PL | 1      | 0       | 1        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| UAB123 | 20150915| D|| CA | 192    | 0       | 0        || PL | 2      | 0       | 0        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| UAB123 | 20150921| G|| CA | 0      | 288     | 288      || PL | 0      | 3       | 3        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+

.. note::
   #. Each unit transaction posted twice: first to the product, lot control, 
      and condition record, and then to the summary product and condition
      record.
   #. Column **C** shows the condition code of goods in inventory. Balances 
      with condition other than "G(ood)" are not included in availability.

---

CDE456 Transaction Balances
=============================

Product CDE456, which is tracked by lot control but not by unit number, has 22 
unit bundles in inventory. Two bundles have odd counts due to printing overruns 
or underruns. 

CDE456 Transactions
-----------------------------

+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| TP | SS| POSTDATE  | PRODUCT | CONTROL  | UNIT ID  | C| UOM| ON-HAND | RESERVED| COUNTPER|
+====+===+===========+=========+==========+==========+==+====+=========+=========+=========+
| --- 10 uniform bundles and one overrun received on 08-20-2015 ---                        |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-20-2015| CDE456  | JOB1259  |          | G| PC | 2700    | 0       | 270     |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-20-2015| CDE456  | JOB1259A | 282      | G| PC | 282     | 0       | 282     |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| --- 10 uniform bundles and one underrun received on 08-23-2015 ---                       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-23-2015| CDE456  | JOB1342  |          | G| PC | 2700    | 0       | 270     |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-23-2015| CDE456  | JOB1342A | 259      | G| PC | 259     | 0       | 259     |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| --- 1 shipments of a full bundle and a partial bundle ---                                |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-25-2015| CDE456  | JOB1259  |          | G| PC | -270    | 0       | 270     |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-25-2015| CDE456  | JOB1259A | 282      | G| PC | -130    | 0       | 282     |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+

.. note::
   #. Each transaction line represents one or more bundle units with a uniform 
      condition code and count.
   #. Where the count per unit was over or under, a new lot control number was
      required to differentiate the count (e.g., JOB1342A versus JOB1342).
   #. To preserve the maximum number of uniform units, the partial withdrawal 
      was taken from the overrun bundle. At most one unit should be partial at 
      a time in any lot.

CDE456 Balances
-----------------------------

+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| Product| Control | C|| UOM| On-Hand| Reserved| Available|| UOM| On-Hand| Reserved| Available|
+========+=========+==++====+========+=========+==========++====+========+=========+==========+
| CDE456 |         | G|| PC | 5541   | 0       | 5541     || BD | 21     | 0       | 21       |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| CDE456 | JOB1259 | G|| PC | 2430   | 0       | 2430     || BD | 9      | 0       | 9        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| CDE456 | JOB1259A| G|| PC | 152    | 0       | 152      || BD | 1      | 0       | 1        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| CDE456 | JOB1342 | G|| PC | 2700   | 0       | 2700     || BD | 10     | 0       | 10       |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| CDE456 | JOB1342A| G|| PC | 259    | 0       | 259      || BD | 1      | 0       | 1        |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+

.. note::
   #. Each transaction line posted twice: first to the product and lot control 
      record, and then to the summary product record.

---

PFG789 Transaction Balances
=============================

Product PFG789 is 4-way whitewood pallets which are used to store and ship 
goods that are received floor-stacked in ocean containers. The warehouse 
receives pallets in truckloads of 400 each, while each ocean container they 
unload needs 40 pallets for product segregation and storage.

PFG789 Transactions
-----------------------------

+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| TP | SS| POSTDATE  | PRODUCT | CONTROL  | UNIT ID  | C| UOM| ON-HAND | RESERVED| COUNTPER|
+====+===+===========+=========+==========+==========+==+====+=========+=========+=========+
| --- 400 empty pallets received on 08-16-2015 ---                                         |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-16-2015| PFG789  |          |          | G| PC | 400     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| --- pallets consumed 40 at a time ---                                                    |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-17-2015| PFG789  |          |          | G| PC | -40     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-17-2015| PFG789  |          |          | G| PC | -40     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-17-2015| PFG789  |          |          | G| PC | -40     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-18-2015| PFG789  |          |          | G| PC | -40     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-18-2015| PFG789  |          |          | G| PC | -40     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-18-2015| PFG789  |          |          | G| PC | -40     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-19-2015| PFG789  |          |          | G| PC | -40     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-19-2015| PFG789  |          |          | G| PC | -40     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| SH | 3 | 08-19-2015| PFG789  |          |          | G| PC | -40     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| --- 400 empty pallets received on 08-19-2015 ---                                         |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+
| RE | 3 | 08-19-2015| PFG789  |          |          | G| PC | 400     | 0       | 1       |
+----+---+-----------+---------+----------+----------+--+----+---------+---------+---------+

PFG789 Balances
-----------------------------

+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+
| Product| Control | C|| UOM| On-Hand| Reserved| Available|| UOM| On-Hand| Reserved| Available|
+========+=========+==++====+========+=========+==========++====+========+=========+==========+
| PFG789 |         | G|| PC | 440    |         | 440      || EA | 440    |         | 440      |
+--------+---------+--++----+--------+---------+----------++----+--------+---------+----------+

.. note::
   Each transaction line posted to the product balance record. Lots and control 
   numbers are not used and do not exist for this product.
 
