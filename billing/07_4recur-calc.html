<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Calculating Recurring Charges &mdash; WARES Billing 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/aaltsys.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="WARES Billing 1.0 documentation" href="index.html" />
    <link rel="next" title="Customer Invoices" href="09_invoices.html" />
    <link rel="prev" title="Recurring Issues and Examples" href="07_3recur-example.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="09_invoices.html" title="Customer Invoices"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="07_3recur-example.html" title="Recurring Issues and Examples"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">WARES Billing 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Calculating Recurring Charges</a><ul>
<li><a class="reference internal" href="#recurring-calculation">Recurring Calculation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="07_3recur-example.html"
                        title="previous chapter">Recurring Issues and Examples</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="09_invoices.html"
                        title="next chapter">Customer Invoices</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/07_4recur-calc.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="calculating-recurring-charges">
<span id="bill-recur-calc"></span><h1>Calculating Recurring Charges<a class="headerlink" href="#calculating-recurring-charges" title="Permalink to this headline">¶</a></h1>
<p>Recurring is calculated across a date interval or period. The balances of
active lots are determined for the start of the period, and the transaction
activity completed within the period is then accumulated to determine an ending
balance.</p>
<p>Recurring is audited by comparing the ending balance of a lot in one period to
the starting balance in the succeeding period, and comparing the total of lot
transactions in a period with the difference between starting and ending
balances.</p>
<div class="section" id="recurring-calculation">
<h2>Recurring Calculation<a class="headerlink" href="#recurring-calculation" title="Permalink to this headline">¶</a></h2>
<p>While recurring selects multiple accounts to process in a batch, each account
is calculated and reported separately. This allows accounts with outstanding
issues to be skipped, while completing billing for other accounts.</p>
<p>To calculate recurring, first unverified transactions for the account with
<strong>Posted</strong> dates before and including the account&#8217;s recurring calendar <strong>Next</strong>
date are selected. If any transactions are found the account is skipped; the
recurring calendar for the account is not updated.</p>
<div class="sidebar">
<p class="first sidebar-title">Recurring Configuration Sources</p>
<table border="1" class="last docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="2"><div class="first last line-block">
<div class="line"><em class="menuselection">Setup ‣ Accounts</em></div>
</div>
</td>
</tr>
<tr class="row-even"><td colspan="2"><strong>Account</strong> identifier of the account</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><strong>Recur</strong> code</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><strong>Receive</strong> code</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">anniversary</div>
<div class="line">starting balances</div>
<div class="line">ending balances</div>
<div class="line">full month</div>
<div class="line">half month</div>
<div class="line">prorated</div>
</div>
</td>
</tr>
<tr class="row-even"><td colspan="2"><strong>Freedays</strong> days before receiving is charged</td>
</tr>
<tr class="row-odd"><td colspan="2"><div class="first last line-block">
<div class="line"><em class="menuselection">Setup ‣ Calendars</em></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Identified by:</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><strong>Group</strong> = <strong>Account</strong></div>
<div class="line"><strong>Code</strong> = <strong>1S</strong></div>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><div class="first last line-block">
<div class="line"><strong>Last + 1</strong> begins calculation interval</div>
<div class="line"><strong>Next</strong> ends calculation interval</div>
</div>
</td>
</tr>
<tr class="row-even"><td colspan="2"><div class="first last line-block">
<div class="line"><em class="menuselection">Setup ‣ Products</em></div>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><div class="first last line-block">
<div class="line">identified by:</div>
<div class="line"><strong>Account</strong>, <strong>Product</strong>, and <strong>Variety</strong></div>
</div>
</td>
</tr>
<tr class="row-even"><td colspan="2"><div class="first last line-block">
<div class="line"><strong>Group</strong> rates for receiving and recurring</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><strong>UOM</strong> codes for</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><em>Units</em></div>
<div class="line"><em>Packages</em></div>
<div class="line"><em>Inners</em></div>
<div class="line"><em>Weight</em></div>
<div class="line"><em>DIM</em></div>
</div>
</td>
</tr>
<tr class="row-even"><td colspan="2"><div class="first last line-block">
<div class="line"><em class="menuselection">Entry ‣ Transactions</em></div>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><div class="first last line-block">
<div class="line"><strong>Posted</strong> DateTime of inventory change</div>
<div class="line"><strong>Entered</strong> DateTime transaction is verified</div>
</div>
</td>
</tr>
<tr class="row-even"><td colspan="2"><div class="first last line-block">
<div class="line"><em class="menuselection">Inventory ‣ Lots</em></div>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><div class="first last line-block">
<div class="line">Identified by:</div>
<div class="line"><strong>Account</strong>, <strong>Product</strong>, <strong>Variety</strong>,</div>
<div class="line"><strong>Control</strong>, and <strong>Posted</strong></div>
</div>
</td>
</tr>
<tr class="row-even"><td colspan="2"><strong>Received = Posted + Freedays</strong></td>
</tr>
<tr class="row-odd"><td colspan="2"><div class="first last line-block">
<div class="line"><em class="menuselection">Billing ‣ Rates</em></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Identified by:</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><strong>Group</strong></div>
<div class="line"><strong>Code = 1S</strong> (recurring) or</div>
<div class="line"><strong>Code = 1R</strong> (receiving)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line"><strong>Per</strong> code</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line"><strong>U</strong> <em>(Unit)</em></div>
<div class="line"><strong>P</strong> <em>(Package)</em></div>
<div class="line"><strong>I</strong> <em>(Inner)</em></div>
<div class="line"><strong>W</strong> <em>(Net Weight)</em></div>
<div class="line"><strong>G</strong> <em>(Gross Weight)</em></div>
<div class="line"><strong>V</strong> <em>(Volume</em> or <em>DIM)</em></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>For accounts which pass the preceding test, active inventory lot records, lots
which are not <strong>Archived</strong>, are selected for the account by <strong>Product</strong>,
<strong>Variety</strong>, lot <strong>Control</strong> number, and <strong>Posted</strong> date. An accumulator
array is initialized to keep inventory balance information by <strong>Product</strong> and
<strong>Variety</strong>.</p>
<p>For each lot, anniversary <strong>Starting</strong> and <strong>Ending</strong> dates are determined. <a class="footnote-reference" href="#id5" id="id1">[1]</a></p>
<ol class="arabic simple">
<li>If the account has free days <a class="footnote-reference" href="#id6" id="id2">[2]</a>, and if the <strong>Received</strong> date (meaning the
Posted date + Free days) is within the recurring interval, then the
<strong>Starting</strong> anniversary date is set to the <strong>Received</strong> date, and a
receiving calculation flag is raised.</li>
<li>If the account uses anniversary recurring: (1) if the receiving flag is
raised then the <strong>Ending</strong> date is left blank, or (2) if the lot anniversary
falls within the recurring interval then the <strong>Ending</strong> date is set to the
anniversary <strong>Date - 1</strong> and the <strong>Starting</strong> date is set to the previous
month&#8217;s anniversary day, or (3) otherwise the lot is skipped. <a class="footnote-reference" href="#id7" id="id3">[3]</a></li>
<li>If the account uses periodic recurring, (1) if the receiving flag is raised
and the account bills from starting balances then the <strong>Ending</strong> date is
left blank, else the <strong>Ending</strong> date is set to the calendar <strong>Next</strong> date,
and if the receiving flag is not raised, the lot anniversary <strong>Starting</strong>
date is set to the calendar date <strong>Last + 1</strong>.</li>
</ol>
<p>Once lot anniversary dates are set, transactions are selected for the lot (that
is, by <strong>Account</strong>, <strong>Product</strong>, <strong>Variety</strong>, lot <strong>Control</strong>, and <strong>Posted</strong>
date), and each lot is processed to determine balances.</p>
<ol class="arabic simple">
<li>Transactions <strong>Received</strong> prior to the lot anniversary <strong>Starting</strong> date are
selected, and transaction quantities are summed to obtain the starting
balances for the lot. A starting balances array is stored.</li>
<li>If an <strong>Ending</strong> date is set then receiving transactions are selected with
<strong>Received</strong> date from the <strong>Starting</strong> date through the <strong>Ending</strong> date.
The transactions are summed and a received balances array is stored.</li>
<li>In the same way as receiving, shipping and adjusting transactions are
selected, summed, and stored in shipped and adjusted arrays.</li>
<li>If a lot has zero balance at the <strong>Starting</strong> date, and no transactions
occur on or after the starting date, then the lot and all associated
transactions are set to <strong>Archived</strong> status and the lot is skipped. Lots
which have no transactions at all are deleted.</li>
</ol>
<p>At this point, recurring audits and charges can be prepared for the lot.</p>
<ol class="arabic simple">
<li>The rate <strong>Group</strong> is determined from the lot&#8217;s <strong>Product/Variety</strong>
information, and the recurring per code (and the receiving per code, if the
receiving flag is raised) is used to determine the quantities to use for the
stock activity audit: Units, Packages, Inners, Net weight, Gross weight, or
DIM/Volume.</li>
<li>If the receiving calculation flag is raised, a receiving storage audit is
written using <strong>Starting</strong> balances for the receiving per code.</li>
<li>If recurring is calculated from <strong>Starting</strong> balances, and the receiving
flag is not raised, then a recurring storage audit is written using the
<strong>Starting</strong> balances for the recurring per code.</li>
<li>If recurring is calculated from <strong>Ending</strong> balances or by <strong>Anniversary</strong>,
and the <strong>Ending</strong> date is not null, then a recurring storage audit is
written using the <strong>Ending</strong> balances for the recurring per code.</li>
<li>The inventory quantity accumulator array is updated with the lot quantities.</li>
</ol>
<p>After calculating all the lots for a product, that is, when a product/variety
break occurs, a recurring charge line is generated from the product accumulator
array. If the account has free days, a separate charge line is generated for
any received quantities. <a class="footnote-reference" href="#id8" id="id4">[4]</a> Then the array is re-initialized for the next
product.</p>
<hr class="docutils" />
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Where a <strong>Received</strong> monthday falls at the end of a month, subsequent
months which do not include the day will use the last day of the month
for the anniversary.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>A lot <strong>Received</strong> date is set to the <strong>Posted</strong> date unless the account
has free days and the posting is from a receipt, in which case the lot
<strong>Received</strong> date is set to the transaction <strong>Posted</strong> date plus the
number of free days.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><strong>Anniversary</strong> method recurring calendars must preclude having two
anniversary dates fall in the same calculation interval.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td>A billing UOM is specified in the rate, separate from the inventory per
code. A factor or deficit formula is applied to inventory quantities to
calculate billing quantities, so that the amounts billed may not match
the exact inventory shown on the corresponding Stock Activity report.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td><p class="first">Section 5.c. of <strong>INTERNATIONAL REFRIGERATED WAREHOUSE CONTRACT TERMS
AND CONDITIONS</strong> states:</p>
<blockquote>
<div><em>If storage rates are quoted on an “ANNIVERSARY BASIS” the storage
month shall extend from date of receipt in one calendar month to, but
not including, the same date of the next month.</em></div></blockquote>
<p>This rule is applied to determine anniversary audit <strong>Starting</strong> and
<strong>Ending</strong> dates as follows:</p>
<ol class="last arabic simple">
<li>The calculation month and year is taken from the calendar <strong>Next</strong>
date.</li>
<li>The <strong>Received</strong> day is combined with the calendar <strong>Next</strong> month and
year to determine the next lot anniversary, although if the
<strong>Received</strong> month day is the first then the month is advanced one
month.</li>
<li>An audit <strong>Ending</strong> date is calculated as the day preceding the
anniversary.</li>
<li>If the lot is received after the first day of the current calendar
month it is skipped, and <strong>Ending</strong> is left blank.</li>
<li>If the <strong>Ending</strong> date is less than or equal to the <strong>Last</strong>
calculation date, or it is greater than the <strong>Next</strong> date, the lot is
skipped and <strong>Ending</strong> is left blank. (The calculation spans only
part of the month, excluding this lot.)</li>
<li>Otherwise an audit <strong>Starting</strong> date is calculated as the anniversary
in the preceding month.</li>
</ol>
</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="09_invoices.html" title="Customer Invoices"
             >next</a></li>
        <li class="right" >
          <a href="07_3recur-example.html" title="Recurring Issues and Examples"
             >previous</a> |</li>
        <li><a href="index.html">WARES Billing 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Gerald Lovel.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3b1.
    </div>
  </body>
</html>